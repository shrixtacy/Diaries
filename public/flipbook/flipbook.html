<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <title>Weekly Zodiac Tarot Flipbook</title>
</head>

<body>
  <div class="flipbook">
    <div class="hard">
      <img src="images/Weekly Zodiac Tarot 2.jpg" alt="Cover - Zodiac Tarot Card 2" />
    </div>
    <div class="hard">
      <img src="images/Weekly Zodiac Tarot 3.jpg" alt="Inside Cover - Zodiac Tarot Card 3" />
    </div>
    <div>
      <img src="images/Weekly Zodiac Tarot 1.jpg" alt="Zodiac Tarot Card 1" />
    </div>
    <div>
      <img src="images/Weekly Zodiac Tarot 2.jpg" alt="Zodiac Tarot Card 2" />
    </div>
    <div>
      <img src="images/Weekly Zodiac Tarot 3.jpg" alt="Zodiac Tarot Card 3" />
    </div>
    <div>
      <img src="images/Weekly Zodiac Tarot 4.jpg" alt="Zodiac Tarot Card 4" />
    </div>
    <div>
      <img src="images/Weekly Zodiac Tarot 5.jpg" alt="Zodiac Tarot Card 5" />
    </div>
    <div>
      <img src="images/Weekly Zodiac Tarot 6.jpg" alt="Zodiac Tarot Card 6" />
    </div>
    <div>
      <img src="images/Weekly Zodiac Tarot 7.jpg" alt="Zodiac Tarot Card 7" />
    </div>
    <div>
      <img src="images/Weekly Zodiac Tarot 8.jpg" alt="Zodiac Tarot Card 8" />
    </div>
    <div>
      <img src="images/Weekly Zodiac Tarot 9.jpg" alt="Zodiac Tarot Card 9" />
    </div>
    <div>
      <img src="images/Weekly Zodiac Tarot 10.jpg" alt="Zodiac Tarot Card 10" />
    </div>
    <div>
      <img src="images/Weekly Zodiac Tarot 11.jpg" alt="Zodiac Tarot Card 11" />
    </div>
    <div>
      <img src="images/Weekly Zodiac Tarot 12.jpg" alt="Zodiac Tarot Card 12" />
    </div>
    <div class="hard">
      <img src="images/Weekly Zodiac Tarot 12.jpg" alt="Second to Last - Zodiac Tarot Card 12" />
    </div>
    <div class="hard">
      <img src="images/Weekly Zodiac Tarot 13.jpg" alt="End - Zodiac Tarot Card 13" />
    </div>
  </div>

  <!-- Turn Page Overlay -->
  <div id="turnPageOverlay" class="turn-page-overlay">
    <div class="turn-page-content">
      <p class="turn-page-message">Click to turn the page</p>
      <button id="turnPageBtn" class="turn-page-btn">Turn Page</button>
    </div>
  </div>

  <script src="jquery.js"></script>
  <script src="turn.js"></script>
  <script>
    $(document).ready(function() {
      // Get container dimensions for responsive sizing
      const container = $(".flipbook").parent();
      const containerWidth = container.width();
      const containerHeight = container.height();
      
      // Calculate responsive dimensions
      const maxWidth = Math.min(containerWidth * 0.95, 1000);
      const maxHeight = Math.min(containerHeight * 0.95, 600);
      const aspectRatio = 1000 / 600; // Original aspect ratio
      
      let flipbookWidth, flipbookHeight;
      
      if (maxWidth / maxHeight > aspectRatio) {
        // Height is the limiting factor
        flipbookHeight = maxHeight;
        flipbookWidth = maxHeight * aspectRatio;
      } else {
        // Width is the limiting factor
        flipbookWidth = maxWidth;
        flipbookHeight = maxWidth / aspectRatio;
      }
      
      let flipbook = $(".flipbook").turn({
        width: flipbookWidth,
        height: flipbookHeight,
        autoCenter: true,
        acceleration: true,
        elevation: 50,
        gradients: true,
        turnCorners: 'page', // Enable all corner turning
        when: {
          turning: function(event, page, view) {
            console.log('Turning to page:', page);
            $('#turnPageOverlay').fadeOut(300);
          },
          turned: function(event, page, view) {
            setTimeout(() => {
              if (page < flipbook.turn('pages')) {
                $('#turnPageOverlay').fadeIn(500);
              }
            }, 1000);
          },
          start: function(event, pageObject, corner) {
            // Ensure all corners work properly
            console.log('Starting turn from corner:', corner);
          }
        }
      });

      // Turn page button functionality
      $('#turnPageBtn').click(function() {
        flipbook.turn('next');
      });

      // Function to slowly open the flipbook
      function slowlyOpenFlipbook() {
        let currentPage = 1;
        const targetPage = 3;
        const pageInterval = 800;
        
        const turnNextPage = () => {
          if (currentPage < targetPage) {
            currentPage++;
            flipbook.turn('page', currentPage);
            setTimeout(turnNextPage, pageInterval);
          } else {
            setTimeout(() => {
              $('#turnPageOverlay').fadeIn(500);
            }, 1000);
          }
        };
        
        setTimeout(turnNextPage, 500);
      }

      // Function to resize flipbook
      function resizeFlipbook() {
        const container = $(".flipbook").parent();
        const containerWidth = container.width();
        const containerHeight = container.height();
        
        const maxWidth = Math.min(containerWidth * 0.95, 1000);
        const maxHeight = Math.min(containerHeight * 0.95, 600);
        const aspectRatio = 1000 / 600;
        
        let newWidth, newHeight;
        
        if (maxWidth / maxHeight > aspectRatio) {
          newHeight = maxHeight;
          newWidth = maxHeight * aspectRatio;
        } else {
          newWidth = maxWidth;
          newHeight = maxWidth / aspectRatio;
        }
        
        flipbook.turn('size', newWidth, newHeight);
      }

      // Listen for window resize events
      window.addEventListener('resize', function() {
        setTimeout(resizeFlipbook, 100);
      });

      // Listen for messages from parent window
      window.addEventListener('message', function(event) {
        if (event.data.type === 'openFlipbook') {
          slowlyOpenFlipbook();
        }
      });
    });
  </script>
</body>

</html>